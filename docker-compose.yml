version: '3'

services:
  php:
    build: ./php5.6
    ports:
    - "80:80"
    - "443:443"
    volumes:
    - ../dev:/var/www/html
    links:
    - mysql
    - mongo

  mysql:
    build: ./mysql5.7
    ports: 
    - "3306:3306"
    volumes:
    - ../db/mysql:/var/lib/mysql
    environment:
    - MYSQL_HOST=127.0.0.1
    - MYSQL_PORT=3306
    - MYSQL_DATABASE=${DEFAULT_DATABASE}
    - MYSQL_USER=${DEFAULT_USER}
    - MYSQL_PASSWORD=${DEFAULT_PASSWORD}
    - MYSQL_ROOT_PASSWORD=${DEFAULT_ROOT_PASSWORD}

  mongo:
    build: ./mongo
    ports:
    - "27017:27017"
    volumes:
    - ../db/mongo:/data/db
    environment:
    - MONGODB_ROOT_USERNAME=${DEFAULT_ROOT_USER}
    - MONGODB_ROOT_PASSWORD=${DEFAULT_ROOT_PASSWORD}